import numpy
import torch


def zero_image(x, y):
    return numpy.zeros((x, y, 3))


def one_image(x, y):
    return numpy.ones((x, y, 3))


def shift_half():
    return 0, 0.5


def shift_thirds():
    return 0.33, 0.66


def close_equal(first, second):
    if torch.is_tensor(first) and torch.is_tensor(second):
        return torch.allclose(first, second, 1e-9, 1e-11)
    else:
        return numpy.allclose(first, second, 1e-9, 1e-11)


def test_img0():
    return numpy.arange(8 * 8 * 3).reshape((8, 8, 3)).astype(numpy.float64)


def downscaled_img0():
    return numpy.array([[[40.5, 41.5, 42.5],
                         [52.5, 53.5, 54.5]],
                        [[136.5, 137.5, 138.5],
                         [148.5, 149.5, 150.5]]])


def downscaled_img0_shift_half():
    return numpy.array([[[40.5, 41.5, 42.5],
                         [52.5, 53.5, 54.5]],
                        [[142.5, 143.5, 144.5],
                         [152.25, 153.25, 154.25]]])


def downscaled_img0_shift_thirds():
    return numpy.array([[[44.46, 45.46, 46.46],
                         [55.23, 56.23, 57.23]],
                        [[144.42, 145.42, 146.42],
                         [152.73, 153.73, 154.73]]])


def test_img1():
    return numpy.array([[[152, 113, 133],
                         [115, 149, 64],
                         [53, 0, 228],
                         [125, 60, 17],
                         [153, 154, 128],
                         [158, 134, 20],
                         [250, 253, 108],
                         [219, 57, 95]],
                        [[69, 104, 66],
                         [209, 84, 10],
                         [179, 164, 28],
                         [20, 178, 20],
                         [252, 96, 65],
                         [231, 61, 59],
                         [231, 77, 167],
                         [211, 68, 8]],
                        [[136, 184, 186],
                         [18, 163, 88],
                         [135, 126, 182],
                         [188, 153, 85],
                         [122, 97, 209],
                         [57, 233, 139],
                         [27, 61, 16],
                         [161, 104, 57]],
                        [[92, 62, 0],
                         [182, 250, 79],
                         [101, 33, 190],
                         [166, 234, 202],
                         [86, 244, 252],
                         [0, 36, 61],
                         [94, 91, 228],
                         [235, 156, 26]],
                        [[250, 199, 10],
                         [70, 113, 225],
                         [165, 67, 62],
                         [244, 15, 190],
                         [127, 156, 242],
                         [218, 116, 112],
                         [58, 243, 139],
                         [26, 84, 87]],
                        [[205, 228, 74],
                         [143, 131, 16],
                         [61, 50, 245],
                         [130, 227, 14],
                         [150, 169, 93],
                         [253, 127, 218],
                         [64, 173, 96],
                         [98, 155, 215]],
                        [[109, 198, 171],
                         [71, 98, 103],
                         [65, 171, 15],
                         [75, 190, 246],
                         [141, 55, 89],
                         [63, 94, 122],
                         [87, 161, 214],
                         [191, 88, 96]],
                        [[13, 27, 40],
                         [122, 247, 99],
                         [83, 57, 45],
                         [45, 141, 191],
                         [157, 187, 87],
                         [210, 122, 102],
                         [77, 52, 7],
                         [37, 65, 93]]])


def downscaled_img1():
    return numpy.array(([[[121.25, 128.5625, 98.625],
                          [155.4375, 120.125, 102.375]],
                         [[115.6875, 134.9375, 109.125],
                          [122.3125, 127.9375, 125.75]]]))


def downscaled_img1_shift_half():
    return numpy.array([[[121.25, 128.5625, 98.625],
                         [155.4375, 120.125, 102.375]],
                        [[136.6875, 121.5, 129.5625],
                         [83.875, 112.8125, 120.5625]]])


def downscaled_img1_shift_thirds():
    return numpy.array([[[129.94, 132.9225, 116.1975],
                         [176.35, 105.67, 71.265]],
                        [[133.1675, 132.86, 133.1225],
                         [86.515, 103.3325, 121.9625]]])
